services:
  app:
    # 定义服务名称
    container_name: fanren-sync
    
    # 使用当前目录下的 Dockerfile 进行构建
    build: .
    image: fanren-sync:latest
    
    # 从 .env 文件加载环境变量
    # 确保项目根目录下存在 .env 文件，并包含 SYNC_PASSWORD=your_password
    env_file:
      - .env
      
    # 端口映射: <主机端口>:<容器端口>
    ports:
      - "8000:8000"
      
    # 数据卷挂载: <主机路径>:<容器路径>
    # 将本地的 data 目录挂载到容器的 /app/data 目录
    # 这样可以确保即使容器被删除，数据也能持久化保存
    volumes:
      - ./data:/app/data
      
    # 配置容器的重启策略
    # unless-stopped: 除非手动停止，否则容器总是在退出时重启
    restart: unless-stopped
