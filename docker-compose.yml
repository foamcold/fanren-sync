services:
  app:
    # 定义服务名称
    container_name: fanren-sync-service
    
    # 使用当前目录下的 Dockerfile 进行构建
    build: .
    
    # 直接在下面设置环境变量
    # 为了安全，建议在这里使用变量替换 `${SYNC_PASSWORD}`
    # 并在执行 docker-compose 命令的环境中提前导出该变量
    # 或者直接在这里写入密码（不推荐用于生产环境）
    environment:
      - SYNC_PASSWORD=${SYNC_PASSWORD}
      
    # 端口映射: <主机端口>:<容器端口>
    ports:
      - "8000:8000"
      
    # 数据卷挂载: <主机路径>:<容器路径>
    # 将本地的 data 目录挂载到容器的 /app/data 目录
    # 这样可以确保即使容器被删除，数据也能持久化保存
    volumes:
      - ./data:/app/data
      
    # 配置容器的重启策略
    # unless-stopped: 除非手动停止，否则容器总是在退出时重启
    restart: unless-stopped
