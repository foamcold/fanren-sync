services:
  app:
    # 定义服务名称
    container_name: fanren-sync
    
    # 使用 Docker Hub 镜像
    # AMD64 架构 (x86_64)
    image: foamcold/fanren-sync:amd
    # ARM64 架构 (Apple Silicon / Raspberry Pi) - 请取消注释下一行并注释上一行
    # image: foamcold/fanren-sync:arm
    
    # 环境变量配置
    # 支持从 Shell 环境变量或 .env 文件读取 SYNC_PASSWORD
    environment:
      - SYNC_PASSWORD=${SYNC_PASSWORD}
      
    # 端口映射: <主机端口>:<容器端口>
    ports:
      - "8000:8000"
      
    # 数据卷挂载: <主机路径>:<容器路径>
    # 将本地的 data 目录挂载到容器的 /app/data 目录
    # 这样可以确保即使容器被删除，数据也能持久化保存
    volumes:
      - ./data:/app/data
      
    # 配置容器的重启策略
    # unless-stopped: 除非手动停止，否则容器总是在退出时重启
    restart: unless-stopped
